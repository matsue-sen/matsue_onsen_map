// @geolonia/normalize-japanese-addresses@3.1.3 downloaded from https://ga.jspm.io/npm:@geolonia/normalize-japanese-addresses@3.1.3/dist/main-esm.mjs

function t(E,O,L,U){return new(L||(L=Promise))((function(ot,at){function o(E){try{c(U.next(E))}catch(E){at(E)}}function a(E){try{c(U.throw(E))}catch(E){at(E)}}function c(E){var O;E.done?ot(E.value):(O=E.value,O instanceof L?O:new L((function(E){E(O)}))).then(o,a)}c((U=U.apply(E,O||[])).next())}))}function e(E){return E&&E.__esModule&&Object.prototype.hasOwnProperty.call(E,"default")?E.default:E}"function"==typeof SuppressedError&&SuppressedError;var E,O={},L={},U={};var ot,at,lt,dt={};function l(){if(ot)return dt;ot=1,Object.defineProperty(dt,"__esModule",{value:!0});return dt.default={"〇":0,"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9,"０":0,"１":1,"２":2,"３":3,"４":4,"５":5,"６":6,"７":7,"８":8,"９":9},dt}function d(){return at||(at=1,function(O){Object.defineProperty(O,"__esModule",{value:!0}),O.zen2han=O.n2kan=O.kan2n=O.splitLargeNumber=O.normalize=O.smallNumbers=O.largeNumbers=void 0;const L=(E||(E=1,Object.defineProperty(U,"__esModule",{value:!0}),U.default={"零":"〇","壱":"一","壹":"一","弐":"二","弍":"二","貳":"二","貮":"二","参":"三","參":"三","肆":"四","伍":"五","陸":"六","漆":"七","捌":"八","玖":"九","拾":"十","廿":"二十","陌":"百","佰":"百","阡":"千","仟":"千","萬":"万"}),U),ot=l();function r(E){if(E.match(/^[0-9]+$/))return Number(E);let L=o(E),U=0;for(const E in O.smallNumbers){const at=new RegExp(`(.*)${E}`),lt=L.match(at);if(lt){let at=1;lt[1]&&(at=lt[1].match(/^[0-9]+$/)?Number(lt[1]):ot.default[lt[1]]),U+=at*O.smallNumbers[E],L=L.replace(lt[0],"")}}if(L)if(L.match(/^[0-9]+$/))U+=Number(L);else for(let E=0;E<L.length;E++){const O=L[E],at=L.length-E-1;U+=ot.default[O]*10**at}return U}function o(E){return E.replace(/[０-９]/g,(E=>String.fromCharCode(E.charCodeAt(0)-65248)))}O.largeNumbers={"兆":1e12,"億":1e8,"万":1e4},O.smallNumbers={"千":1e3,"百":100,"十":10},O.normalize=function(E){for(const O in L.default){const U=new RegExp(O,"g");E=E.replace(U,L.default[O])}return E},O.splitLargeNumber=function(E){let L=E;const U={};for(const E in O.largeNumbers){const O=new RegExp(`(.+)${E}`),ot=L.match(O);ot?(U[E]=r(ot[1]),L=L.replace(ot[0],"")):U[E]=0}return U["千"]=L?r(L):0,U},O.kan2n=r,O.n2kan=function(E){const L=Object.keys(ot.default);let U=E,at="";for(const E in O.smallNumbers){const ot=Math.floor(U/O.smallNumbers[E]);ot&&(U-=ot*O.smallNumbers[E],at=1===ot?`${at}${E}`:`${at}${L[ot]}${E}`)}return U&&(at=`${at}${L[U]}`),at},O.zen2han=o}(L)),L}var ft=function(){if(lt)return O;lt=1,Object.defineProperty(O,"__esModule",{value:!0}),O.findKanjiNumbers=O.number2kanji=O.kanji2number=void 0;const E=d(),L=l();return O.kanji2number=function(O){if((O=(0,E.normalize)(O)).match("〇")||O.match(/^[〇一二三四五六七八九]+$/)){for(const E in L.default){const U=new RegExp(E,"g");O=O.replace(U,L.default[E].toString())}return Number(O)}{let L=0;const U=(0,E.splitLargeNumber)(O);for(const O in E.largeNumbers)U[O]&&(L+=E.largeNumbers[O]*U[O]);if(!Number.isInteger(L)||!Number.isInteger(U["千"]))throw new TypeError("The attribute of kanji2number() must be a Japanese numeral as integer.");return L+U["千"]}},O.number2kanji=function(O){if(!O.toString().match(/^[0-9]+$/))throw new TypeError("The attribute of number2kanji() must be integer.");Object.keys(L.default);let U=O,ot="";for(const O in E.largeNumbers){const L=Math.floor(U/E.largeNumbers[O]);L&&(U-=L*E.largeNumbers[O],ot=`${ot}${(0,E.n2kan)(L)}${O}`)}return U&&(ot=`${ot}${(0,E.n2kan)(U)}`),ot||"〇"},O.findKanjiNumbers=function(E){const O="([0-9０-９]*)|([〇一二三四五六七八九壱壹弐弍貳貮参參肆伍陸漆捌玖]*)",L=`((${O})(千|阡|仟))?((${O})(百|陌|佰))?((${O})(十|拾))?(${O})?`,U=new RegExp(`((${L}兆)?(${L}億)?(${L}(万|萬))?${L})`,"g"),ot=E.match(U);return ot?ot.filter((E=>!(E.match(/^[0-9０-９]+$/)||!E.length||"兆"===E||"億"===E||"万"===E||"萬"===E))):[]},O}();const pt={japaneseAddressesApi:"https://japanese-addresses-v2.geoloniamaps.com/api/ja",cacheSize:1e3},p=(E,O)=>{const L=O||{};let U=new URL(`${pt.japaneseAddressesApi}${E}`).toString();pt.geoloniaApiKey&&(U+=`?geolonia-api-key=${pt.geoloniaApiKey}`);const ot={};let at;if(void 0!==L.length&&void 0!==L.offset&&(ot.Range=`bytes=${L.offset}-${L.offset+L.length-1}`),"undefined"!=typeof fetch)at=fetch;else{if("undefined"==typeof window)throw new Error("fetch is not available in this environment");at=window.fetch}return at(U,{headers:ot})},g=E=>{const O=ft.findKanjiNumbers(E);for(let L=0;L<O.length;L++)try{E=E.replace(O[L],ft.kanji2number(O[L]))}catch(E){}return E},m=E=>E.replace(/[Ａ-Ｚａ-ｚ０-９]/g,(E=>String.fromCharCode(E.charCodeAt(0)-65248))),gt=[{pref:"香川県",city:"仲多度郡まんのう町",town:"勝浦",pattern:"^字?家[6六]",result:"家六"},{pref:"愛知県",city:"あま市",town:"西今宿",pattern:"^字?梶村[1一]",result:"梶村一"},{pref:"香川県",city:"丸亀市",town:"原田町",pattern:"^字?東三分[1一]",result:"東三分一"}],mt=[[{src:"亞",dst:"亜"},{src:"圍",dst:"囲"},{src:"壹",dst:"壱"},{src:"榮",dst:"栄"},{src:"驛",dst:"駅"},{src:"應",dst:"応"},{src:"櫻",dst:"桜"},{src:"假",dst:"仮"},{src:"會",dst:"会"},{src:"懷",dst:"懐"},{src:"覺",dst:"覚"},{src:"樂",dst:"楽"},{src:"陷",dst:"陥"},{src:"歡",dst:"歓"},{src:"氣",dst:"気"},{src:"戲",dst:"戯"},{src:"據",dst:"拠"},{src:"挾",dst:"挟"},{src:"區",dst:"区"},{src:"徑",dst:"径"},{src:"溪",dst:"渓"},{src:"輕",dst:"軽"},{src:"藝",dst:"芸"},{src:"儉",dst:"倹"},{src:"圈",dst:"圏"},{src:"權",dst:"権"},{src:"嚴",dst:"厳"},{src:"恆",dst:"恒"},{src:"國",dst:"国"},{src:"齋",dst:"斎"},{src:"雜",dst:"雑"},{src:"蠶",dst:"蚕"},{src:"殘",dst:"残"},{src:"兒",dst:"児"},{src:"實",dst:"実"},{src:"釋",dst:"釈"},{src:"從",dst:"従"},{src:"縱",dst:"縦"},{src:"敍",dst:"叙"},{src:"燒",dst:"焼"},{src:"條",dst:"条"},{src:"剩",dst:"剰"},{src:"壤",dst:"壌"},{src:"釀",dst:"醸"},{src:"眞",dst:"真"},{src:"盡",dst:"尽"},{src:"醉",dst:"酔"},{src:"髓",dst:"髄"},{src:"聲",dst:"声"},{src:"竊",dst:"窃"},{src:"淺",dst:"浅"},{src:"錢",dst:"銭"},{src:"禪",dst:"禅"},{src:"爭",dst:"争"},{src:"插",dst:"挿"},{src:"騷",dst:"騒"},{src:"屬",dst:"属"},{src:"對",dst:"対"},{src:"滯",dst:"滞"},{src:"擇",dst:"択"},{src:"單",dst:"単"},{src:"斷",dst:"断"},{src:"癡",dst:"痴"},{src:"鑄",dst:"鋳"},{src:"敕",dst:"勅"},{src:"鐵",dst:"鉄"},{src:"傳",dst:"伝"},{src:"黨",dst:"党"},{src:"鬪",dst:"闘"},{src:"屆",dst:"届"},{src:"腦",dst:"脳"},{src:"廢",dst:"廃"},{src:"發",dst:"発"},{src:"蠻",dst:"蛮"},{src:"拂",dst:"払"},{src:"邊",dst:"辺"},{src:"瓣",dst:"弁"},{src:"寶",dst:"宝"},{src:"沒",dst:"没"},{src:"滿",dst:"満"},{src:"藥",dst:"薬"},{src:"餘",dst:"余"},{src:"樣",dst:"様"},{src:"亂",dst:"乱"},{src:"兩",dst:"両"},{src:"禮",dst:"礼"},{src:"靈",dst:"霊"},{src:"爐",dst:"炉"},{src:"灣",dst:"湾"},{src:"惡",dst:"悪"},{src:"醫",dst:"医"},{src:"飮",dst:"飲"},{src:"營",dst:"営"},{src:"圓",dst:"円"},{src:"歐",dst:"欧"},{src:"奧",dst:"奥"},{src:"價",dst:"価"},{src:"繪",dst:"絵"},{src:"擴",dst:"拡"},{src:"學",dst:"学"},{src:"罐",dst:"缶"},{src:"勸",dst:"勧"},{src:"觀",dst:"観"},{src:"歸",dst:"帰"},{src:"犧",dst:"犠"},{src:"擧",dst:"挙"},{src:"狹",dst:"狭"},{src:"驅",dst:"駆"},{src:"莖",dst:"茎"},{src:"經",dst:"経"},{src:"繼",dst:"継"},{src:"缺",dst:"欠"},{src:"劍",dst:"剣"},{src:"檢",dst:"検"},{src:"顯",dst:"顕"},{src:"廣",dst:"広"},{src:"鑛",dst:"鉱"},{src:"碎",dst:"砕"},{src:"劑",dst:"剤"},{src:"參",dst:"参"},{src:"慘",dst:"惨"},{src:"絲",dst:"糸"},{src:"辭",dst:"辞"},{src:"舍",dst:"舎"},{src:"壽",dst:"寿"},{src:"澁",dst:"渋"},{src:"肅",dst:"粛"},{src:"將",dst:"将"},{src:"證",dst:"証"},{src:"乘",dst:"乗"},{src:"疊",dst:"畳"},{src:"孃",dst:"嬢"},{src:"觸",dst:"触"},{src:"寢",dst:"寝"},{src:"圖",dst:"図"},{src:"穗",dst:"穂"},{src:"樞",dst:"枢"},{src:"齊",dst:"斉"},{src:"攝",dst:"摂"},{src:"戰",dst:"戦"},{src:"潛",dst:"潜"},{src:"雙",dst:"双"},{src:"莊",dst:"荘"},{src:"裝",dst:"装"},{src:"藏",dst:"蔵"},{src:"續",dst:"続"},{src:"體",dst:"体"},{src:"臺",dst:"台"},{src:"澤",dst:"沢"},{src:"膽",dst:"胆"},{src:"彈",dst:"弾"},{src:"蟲",dst:"虫"},{src:"廳",dst:"庁"},{src:"鎭",dst:"鎮"},{src:"點",dst:"点"},{src:"燈",dst:"灯"},{src:"盜",dst:"盗"},{src:"獨",dst:"独"},{src:"貳",dst:"弐"},{src:"霸",dst:"覇"},{src:"賣",dst:"売"},{src:"髮",dst:"髪"},{src:"祕",dst:"秘"},{src:"佛",dst:"仏"},{src:"變",dst:"変"},{src:"辯",dst:"弁"},{src:"豐",dst:"豊"},{src:"飜",dst:"翻"},{src:"默",dst:"黙"},{src:"與",dst:"与"},{src:"譽",dst:"誉"},{src:"謠",dst:"謡"},{src:"覽",dst:"覧"},{src:"獵",dst:"猟"},{src:"勵",dst:"励"},{src:"齡",dst:"齢"},{src:"勞",dst:"労"},{src:"壓",dst:"圧"},{src:"爲",dst:"為"},{src:"隱",dst:"隠"},{src:"衞",dst:"衛"},{src:"鹽",dst:"塩"},{src:"毆",dst:"殴"},{src:"穩",dst:"穏"},{src:"畫",dst:"画"},{src:"壞",dst:"壊"},{src:"殼",dst:"殻"},{src:"嶽",dst:"岳"},{src:"卷",dst:"巻"},{src:"關",dst:"関"},{src:"顏",dst:"顔"},{src:"僞",dst:"偽"},{src:"舊",dst:"旧"},{src:"峽",dst:"峡"},{src:"曉",dst:"暁"},{src:"勳",dst:"勲"},{src:"惠",dst:"恵"},{src:"螢",dst:"蛍"},{src:"鷄",dst:"鶏"},{src:"縣",dst:"県"},{src:"險",dst:"険"},{src:"獻",dst:"献"},{src:"驗",dst:"験"},{src:"效",dst:"効"},{src:"號",dst:"号"},{src:"濟",dst:"済"},{src:"册",dst:"冊"},{src:"棧",dst:"桟"},{src:"贊",dst:"賛"},{src:"齒",dst:"歯"},{src:"濕",dst:"湿"},{src:"寫",dst:"写"},{src:"收",dst:"収"},{src:"獸",dst:"獣"},{src:"處",dst:"処"},{src:"稱",dst:"称"},{src:"奬",dst:"奨"},{src:"淨",dst:"浄"},{src:"繩",dst:"縄"},{src:"讓",dst:"譲"},{src:"囑",dst:"嘱"},{src:"愼",dst:"慎"},{src:"粹",dst:"粋"},{src:"隨",dst:"随"},{src:"數",dst:"数"},{src:"靜",dst:"静"},{src:"專",dst:"専"},{src:"踐",dst:"践"},{src:"纖",dst:"繊"},{src:"壯",dst:"壮"},{src:"搜",dst:"捜"},{src:"總",dst:"総"},{src:"臟",dst:"臓"},{src:"墮",dst:"堕"},{src:"帶",dst:"帯"},{src:"瀧",dst:"滝"},{src:"擔",dst:"担"},{src:"團",dst:"団"},{src:"遲",dst:"遅"},{src:"晝",dst:"昼"},{src:"聽",dst:"聴"},{src:"遞",dst:"逓"},{src:"轉",dst:"転"},{src:"當",dst:"当"},{src:"稻",dst:"稲"},{src:"讀",dst:"読"},{src:"惱",dst:"悩"},{src:"拜",dst:"拝"},{src:"麥",dst:"麦"},{src:"拔",dst:"抜"},{src:"濱",dst:"浜"},{src:"竝",dst:"並"},{src:"辨",dst:"弁"},{src:"舖",dst:"舗"},{src:"襃",dst:"褒"},{src:"萬",dst:"万"},{src:"譯",dst:"訳"},{src:"豫",dst:"予"},{src:"搖",dst:"揺"},{src:"來",dst:"来"},{src:"龍",dst:"竜"},{src:"壘",dst:"塁"},{src:"隸",dst:"隷"},{src:"戀",dst:"恋"},{src:"樓",dst:"楼"},{src:"鰺",dst:"鯵"},{src:"鶯",dst:"鴬"},{src:"蠣",dst:"蛎"},{src:"攪",dst:"撹"},{src:"竈",dst:"竃"},{src:"灌",dst:"潅"},{src:"諫",dst:"諌"},{src:"頸",dst:"頚"},{src:"礦",dst:"砿"},{src:"蘂",dst:"蕊"},{src:"靱",dst:"靭"},{src:"賤",dst:"賎"},{src:"壺",dst:"壷"},{src:"礪",dst:"砺"},{src:"檮",dst:"梼"},{src:"濤",dst:"涛"},{src:"邇",dst:"迩"},{src:"蠅",dst:"蝿"},{src:"檜",dst:"桧"},{src:"儘",dst:"侭"},{src:"藪",dst:"薮"},{src:"籠",dst:"篭"},{src:"彌",dst:"弥"},{src:"麩",dst:"麸"},{src:"驒",dst:"騨"}]].flat().reduce(((E,O)=>{const L=`(${O.src}|${O.dst})`;return Object.assign(Object.assign({},E),{[O.src]:L,[O.dst]:L})}),{}),_t=new RegExp(Array.from(new Set(Object.values(mt))).join("|"),"g"),b=E=>{let O=E;return O=O.replace(/三栄町|四谷三栄町/g,"(三栄町|四谷三栄町)").replace(/鬮野川|くじ野川|くじの川/g,"(鬮野川|くじ野川|くじの川)").replace(/柿碕町|柿さき町/g,"(柿碕町|柿さき町)").replace(/通り|とおり/g,"(通り|とおり)").replace(/埠頭|ふ頭/g,"(埠頭|ふ頭)").replace(/番町|番丁/g,"(番町|番丁)").replace(/大冝|大宜/g,"(大冝|大宜)").replace(/穝|さい/g,"(穝|さい)").replace(/杁|えぶり/g,"(杁|えぶり)").replace(/薭|稗|ひえ|ヒエ/g,"(薭|稗|ひえ|ヒエ)").replace(/[之ノの]/g,"[之ノの]").replace(/[ヶケが]/g,"[ヶケが]").replace(/[ヵカか力]/g,"[ヵカか力]").replace(/[ッツっつ]/g,"[ッツっつ]").replace(/[ニ二]/g,"[ニ二]").replace(/[ハ八]/g,"[ハ八]").replace(/塚|塚/g,"(塚|塚)").replace(/釜|竈/g,"(釜|竈)").replace(/條|条/g,"(條|条)").replace(/狛|拍/g,"(狛|拍)").replace(/藪|薮/g,"(藪|薮)").replace(/渕|淵/g,"(渕|淵)").replace(/エ|ヱ|え/g,"(エ|ヱ|え)").replace(/曾|曽/g,"(曾|曽)").replace(/舟|船/g,"(舟|船)").replace(/莵|菟/g,"(莵|菟)").replace(/市|巿/g,"(市|巿)").replace(/崎|﨑/g,"(崎|﨑)"),O=O.replace(_t,(E=>mt[E])),O};var vt,wt={exports:{}};
/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/var yt=e((vt||(vt=1,wt.exports=function t(){var E="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==E?E:{},O=!E.document&&!!E.postMessage,L=E.IS_PAPA_WORKER||!1,U={},ot=0,at={parse:function(O,L){var lt=(L=L||{}).dynamicTyping||!1;if(w(lt)&&(L.dynamicTypingFunction=lt,lt={}),L.dynamicTyping=lt,L.transform=!!w(L.transform)&&L.transform,L.worker&&at.WORKERS_SUPPORTED){var dt=function(){if(!at.WORKERS_SUPPORTED)return!1;var O,L,lt=(O=E.URL||E.webkitURL||null,L=t.toString(),at.BLOB_URL||(at.BLOB_URL=O.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",L,")();"],{type:"text/javascript"})))),dt=new E.Worker(lt);return dt.onmessage=m,dt.id=ot++,U[dt.id]=dt}();return dt.userStep=L.step,dt.userChunk=L.chunk,dt.userComplete=L.complete,dt.userError=L.error,L.step=w(L.step),L.chunk=w(L.chunk),L.complete=w(L.complete),L.error=w(L.error),delete L.worker,void dt.postMessage({input:O,config:L,workerId:dt.id})}var ft=null;return at.NODE_STREAM_INPUT,"string"==typeof O?(O=function(E){return 65279===E.charCodeAt(0)?E.slice(1):E}(O),ft=L.download?new h(L):new d(L)):!0===O.readable&&w(O.read)&&w(O.on)?ft=new u(L):(E.File&&O instanceof File||O instanceof Object)&&(ft=new l(L)),ft.stream(O)},unparse:function(E,O){var L=!1,U=!0,ot=",",lt="\r\n",dt='"',ft=dt+dt,pt=!1,gt=null,mt=!1;!function(){if("object"==typeof O){if("string"!=typeof O.delimiter||at.BAD_DELIMITERS.filter((function(E){return-1!==O.delimiter.indexOf(E)})).length||(ot=O.delimiter),("boolean"==typeof O.quotes||"function"==typeof O.quotes||Array.isArray(O.quotes))&&(L=O.quotes),"boolean"!=typeof O.skipEmptyLines&&"string"!=typeof O.skipEmptyLines||(pt=O.skipEmptyLines),"string"==typeof O.newline&&(lt=O.newline),"string"==typeof O.quoteChar&&(dt=O.quoteChar),"boolean"==typeof O.header&&(U=O.header),Array.isArray(O.columns)){if(0===O.columns.length)throw new Error("Option columns is empty");gt=O.columns}void 0!==O.escapeChar&&(ft=O.escapeChar+dt),("boolean"==typeof O.escapeFormulae||O.escapeFormulae instanceof RegExp)&&(mt=O.escapeFormulae instanceof RegExp?O.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var _t=new RegExp(p(dt),"g");if("string"==typeof E&&(E=JSON.parse(E)),Array.isArray(E)){if(!E.length||Array.isArray(E[0]))return f(null,E,pt);if("object"==typeof E[0])return f(gt||Object.keys(E[0]),E,pt)}else if("object"==typeof E)return"string"==typeof E.data&&(E.data=JSON.parse(E.data)),Array.isArray(E.data)&&(E.fields||(E.fields=E.meta&&E.meta.fields||gt),E.fields||(E.fields=Array.isArray(E.data[0])?E.fields:"object"==typeof E.data[0]?Object.keys(E.data[0]):[]),Array.isArray(E.data[0])||"object"==typeof E.data[0]||(E.data=[E.data])),f(E.fields||[],E.data||[],pt);throw new Error("Unable to serialize unrecognized input");function f(E,O,L){var at="";"string"==typeof E&&(E=JSON.parse(E)),"string"==typeof O&&(O=JSON.parse(O));var dt=Array.isArray(E)&&0<E.length,ft=!Array.isArray(O[0]);if(dt&&U){for(var pt=0;pt<E.length;pt++)0<pt&&(at+=ot),at+=g(E[pt],pt);0<O.length&&(at+=lt)}for(var gt=0;gt<O.length;gt++){var mt=dt?E.length:O[gt].length,_t=!1,vt=dt?0===Object.keys(O[gt]).length:0===O[gt].length;if(L&&!dt&&(_t="greedy"===L?""===O[gt].join("").trim():1===O[gt].length&&0===O[gt][0].length),"greedy"===L&&dt){for(var wt=[],yt=0;yt<mt;yt++){var bt=ft?E[yt]:yt;wt.push(O[gt][bt])}_t=""===wt.join("").trim()}if(!_t){for(var St=0;St<mt;St++){0<St&&!vt&&(at+=ot);var Et=dt&&ft?E[St]:St;at+=g(O[gt][Et],St)}gt<O.length-1&&(!L||0<mt&&!vt)&&(at+=lt)}}return at}function g(E,O){if(null==E)return"";if(E.constructor===Date)return JSON.stringify(E).slice(1,25);var U=!1;mt&&"string"==typeof E&&mt.test(E)&&(E="'"+E,U=!0);var lt=E.toString().replace(_t,ft);return(U=U||!0===L||"function"==typeof L&&L(E,O)||Array.isArray(L)&&L[O]||function(E,O){for(var L=0;L<O.length;L++)if(-1<E.indexOf(O[L]))return!0;return!1}(lt,at.BAD_DELIMITERS)||-1<lt.indexOf(ot)||" "===lt.charAt(0)||" "===lt.charAt(lt.length-1))?dt+lt+dt:lt}}};if(at.RECORD_SEP=String.fromCharCode(30),at.UNIT_SEP=String.fromCharCode(31),at.BYTE_ORDER_MARK="\ufeff",at.BAD_DELIMITERS=["\r","\n",'"',at.BYTE_ORDER_MARK],at.WORKERS_SUPPORTED=!O&&!!E.Worker,at.NODE_STREAM_INPUT=1,at.LocalChunkSize=10485760,at.RemoteChunkSize=5242880,at.DefaultDelimiter=",",at.Parser=g,at.ParserHandle=f,at.NetworkStreamer=h,at.FileStreamer=l,at.StringStreamer=d,at.ReadableStreamStreamer=u,E.jQuery){var lt=E.jQuery;lt.fn.parse=function(O){var L=O.config||{},U=[];return this.each((function(O){if("INPUT"!==lt(this).prop("tagName").toUpperCase()||"file"!==lt(this).attr("type").toLowerCase()||!E.FileReader||!this.files||0===this.files.length)return!0;for(var ot=0;ot<this.files.length;ot++)U.push({file:this.files[ot],inputElem:this,instanceConfig:lt.extend({},L)})})),r(),this;function r(){if(0!==U.length){var E,L,ot,dt,ft=U[0];if(w(O.before)){var pt=O.before(ft.file,ft.inputElem);if("object"==typeof pt){if("abort"===pt.action)return E="AbortError",L=ft.file,ot=ft.inputElem,dt=pt.reason,void(w(O.error)&&O.error({name:E},L,ot,dt));if("skip"===pt.action)return void n();"object"==typeof pt.config&&(ft.instanceConfig=lt.extend(ft.instanceConfig,pt.config))}else if("skip"===pt)return void n()}var gt=ft.instanceConfig.complete;ft.instanceConfig.complete=function(E){w(gt)&&gt(E,ft.file,ft.inputElem),n()},at.parse(ft.file,ft.instanceConfig)}else w(O.complete)&&O.complete()}function n(){U.splice(0,1),r()}}}function c(O){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(E){var O=y(E);O.chunkSize=parseInt(O.chunkSize),E.step||E.chunk||(O.chunkSize=null),this._handle=new f(O),(this._handle.streamer=this)._config=O}.call(this,O),this.parseChunk=function(O,U){if(this.isFirstChunk&&w(this._config.beforeFirstChunk)){var ot=this._config.beforeFirstChunk(O);void 0!==ot&&(O=ot)}this.isFirstChunk=!1,this._halted=!1;var lt=this._partialLine+O;this._partialLine="";var dt=this._handle.parse(lt,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var ft=dt.meta.cursor;this._finished||(this._partialLine=lt.substring(ft-this._baseIndex),this._baseIndex=ft),dt&&dt.data&&(this._rowCount+=dt.data.length);var pt=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(L)E.postMessage({results:dt,workerId:at.WORKER_ID,finished:pt});else if(w(this._config.chunk)&&!U){if(this._config.chunk(dt,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);dt=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(dt.data),this._completeResults.errors=this._completeResults.errors.concat(dt.errors),this._completeResults.meta=dt.meta),this._completed||!pt||!w(this._config.complete)||dt&&dt.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),pt||dt&&dt.meta.paused||this._nextChunk(),dt}this._halted=!0},this._sendError=function(O){w(this._config.error)?this._config.error(O):L&&this._config.error&&E.postMessage({workerId:at.WORKER_ID,error:O,finished:!1})}}function h(E){var L;(E=E||{}).chunkSize||(E.chunkSize=at.RemoteChunkSize),c.call(this,E),this._nextChunk=O?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(E){this._input=E,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(L=new XMLHttpRequest,this._config.withCredentials&&(L.withCredentials=this._config.withCredentials),O||(L.onload=b(this._chunkLoaded,this),L.onerror=b(this._chunkError,this)),L.open(this._config.downloadRequestBody?"POST":"GET",this._input,!O),this._config.downloadRequestHeaders){var E=this._config.downloadRequestHeaders;for(var U in E)L.setRequestHeader(U,E[U])}if(this._config.chunkSize){var ot=this._start+this._config.chunkSize-1;L.setRequestHeader("Range","bytes="+this._start+"-"+ot)}try{L.send(this._config.downloadRequestBody)}catch(E){this._chunkError(E.message)}O&&0===L.status&&this._chunkError()}},this._chunkLoaded=function(){4===L.readyState&&(L.status<200||400<=L.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:L.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(E){var O=E.getResponseHeader("Content-Range");return null===O?-1:parseInt(O.substring(O.lastIndexOf("/")+1))}(L),this.parseChunk(L.responseText)))},this._chunkError=function(E){var O=L.statusText||E;this._sendError(new Error(O))}}function l(E){var O,L;(E=E||{}).chunkSize||(E.chunkSize=at.LocalChunkSize),c.call(this,E);var U="undefined"!=typeof FileReader;this.stream=function(E){this._input=E,L=E.slice||E.webkitSlice||E.mozSlice,U?((O=new FileReader).onload=b(this._chunkLoaded,this),O.onerror=b(this._chunkError,this)):O=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var E=this._input;if(this._config.chunkSize){var ot=Math.min(this._start+this._config.chunkSize,this._input.size);E=L.call(E,this._start,ot)}var at=O.readAsText(E,this._config.encoding);U||this._chunkLoaded({target:{result:at}})},this._chunkLoaded=function(E){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(E.target.result)},this._chunkError=function(){this._sendError(O.error)}}function d(E){var O;c.call(this,E=E||{}),this.stream=function(E){return O=E,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var E,L=this._config.chunkSize;return L?(E=O.substring(0,L),O=O.substring(L)):(E=O,O=""),this._finished=!O,this.parseChunk(E)}}}function u(E){c.call(this,E=E||{});var O=[],L=!0,U=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(E){this._input=E,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){U&&1===O.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),O.length?this.parseChunk(O.shift()):L=!0},this._streamData=b((function(E){try{O.push("string"==typeof E?E:E.toString(this._config.encoding)),L&&(L=!1,this._checkIsFinished(),this.parseChunk(O.shift()))}catch(E){this._streamError(E)}}),this),this._streamError=b((function(E){this._streamCleanUp(),this._sendError(E)}),this),this._streamEnd=b((function(){this._streamCleanUp(),U=!0,this._streamData("")}),this),this._streamCleanUp=b((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function f(E){var O,L,U,ot=Math.pow(2,53),lt=-ot,dt=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ft=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,pt=this,gt=0,mt=0,_t=!1,vt=!1,wt=[],yt={data:[],errors:[],meta:{}};if(w(E.step)){var bt=E.step;E.step=function(O){if(yt=O,S())k();else{if(k(),0===yt.data.length)return;gt+=O.data.length,E.preview&&gt>E.preview?L.abort():(yt.data=yt.data[0],bt(yt,pt))}}}function b(O){return"greedy"===E.skipEmptyLines?""===O.join("").trim():1===O.length&&0===O[0].length}function k(){return yt&&U&&(z("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+at.DefaultDelimiter+"'"),U=!1),E.skipEmptyLines&&(yt.data=yt.data.filter((function(E){return!b(E)}))),S()&&function(){if(yt)if(Array.isArray(yt.data[0])){for(var O=0;S()&&O<yt.data.length;O++)yt.data[O].forEach(s);yt.data.splice(0,1)}else yt.data.forEach(s);function s(O,L){w(E.transformHeader)&&(O=E.transformHeader(O,L)),wt.push(O)}}(),function(){if(!yt||!E.header&&!E.dynamicTyping&&!E.transform)return yt;function e(O,L){var U,ot=E.header?{}:[];for(U=0;U<O.length;U++){var at=U,lt=O[U];E.header&&(at=U>=wt.length?"__parsed_extra":wt[U]),E.transform&&(lt=E.transform(lt,at)),lt=x(at,lt),"__parsed_extra"===at?(ot[at]=ot[at]||[],ot[at].push(lt)):ot[at]=lt}return E.header&&(U>wt.length?z("FieldMismatch","TooManyFields","Too many fields: expected "+wt.length+" fields but parsed "+U,mt+L):U<wt.length&&z("FieldMismatch","TooFewFields","Too few fields: expected "+wt.length+" fields but parsed "+U,mt+L)),ot}var O=1;return!yt.data.length||Array.isArray(yt.data[0])?(yt.data=yt.data.map(e),O=yt.data.length):yt.data=e(yt.data,0),E.header&&yt.meta&&(yt.meta.fields=wt),mt+=O,yt}()}function S(){return E.header&&0===wt.length}function x(O,L){return U=O,E.dynamicTypingFunction&&void 0===E.dynamicTyping[U]&&(E.dynamicTyping[U]=E.dynamicTypingFunction(U)),!0===(E.dynamicTyping[U]||E.dynamicTyping)?"true"===L||"TRUE"===L||"false"!==L&&"FALSE"!==L&&(function(E){if(dt.test(E)){var O=parseFloat(E);if(lt<O&&O<ot)return!0}return!1}(L)?parseFloat(L):ft.test(L)?new Date(L):""===L?null:L):L;var U}function z(E,O,L,U){var ot={type:E,code:O,message:L};void 0!==U&&(ot.row=U),yt.errors.push(ot)}this.parse=function(ot,lt,dt){var ft=E.quoteChar||'"';if(E.newline||(E.newline=function(E,O){E=E.substring(0,1048576);var L=new RegExp(p(O)+"([^]*?)"+p(O),"gm"),U=(E=E.replace(L,"")).split("\r"),ot=E.split("\n"),at=1<ot.length&&ot[0].length<U[0].length;if(1===U.length||at)return"\n";for(var lt=0,dt=0;dt<U.length;dt++)"\n"===U[dt][0]&&lt++;return lt>=U.length/2?"\r\n":"\r"}(ot,ft)),U=!1,E.delimiter)w(E.delimiter)&&(E.delimiter=E.delimiter(ot),yt.meta.delimiter=E.delimiter);else{var pt=function(O,L,U,ot,lt){var dt,ft,pt,gt;lt=lt||[",","\t","|",";",at.RECORD_SEP,at.UNIT_SEP];for(var mt=0;mt<lt.length;mt++){var _t=lt[mt],vt=0,wt=0,yt=0;pt=void 0;for(var bt=new g({comments:ot,delimiter:_t,newline:L,preview:10}).parse(O),St=0;St<bt.data.length;St++)if(U&&b(bt.data[St]))yt++;else{var Et=bt.data[St].length;wt+=Et,void 0!==pt?0<Et&&(vt+=Math.abs(Et-pt),pt=Et):pt=Et}0<bt.data.length&&(wt/=bt.data.length-yt),(void 0===ft||vt<=ft)&&(void 0===gt||gt<wt)&&1.99<wt&&(ft=vt,dt=_t,gt=wt)}return{successful:!!(E.delimiter=dt),bestDelimiter:dt}}(ot,E.newline,E.skipEmptyLines,E.comments,E.delimitersToGuess);pt.successful?E.delimiter=pt.bestDelimiter:(U=!0,E.delimiter=at.DefaultDelimiter),yt.meta.delimiter=E.delimiter}var gt=y(E);return E.preview&&E.header&&gt.preview++,O=ot,L=new g(gt),yt=L.parse(O,lt,dt),k(),_t?{meta:{paused:!0}}:yt||{meta:{paused:!1}}},this.paused=function(){return _t},this.pause=function(){_t=!0,L.abort(),O=w(E.chunk)?"":O.substring(L.getCharIndex())},this.resume=function(){pt.streamer._halted?(_t=!1,pt.streamer.parseChunk(O,!0)):setTimeout(pt.resume,3)},this.aborted=function(){return vt},this.abort=function(){vt=!0,L.abort(),yt.meta.aborted=!0,w(E.complete)&&E.complete(yt),O=""}}function p(E){return E.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(E){var O,L=(E=E||{}).delimiter,U=E.newline,ot=E.comments,lt=E.step,dt=E.preview,ft=E.fastMode,pt=O=void 0===E.quoteChar||null===E.quoteChar?'"':E.quoteChar;if(void 0!==E.escapeChar&&(pt=E.escapeChar),("string"!=typeof L||-1<at.BAD_DELIMITERS.indexOf(L))&&(L=","),ot===L)throw new Error("Comment character same as delimiter");!0===ot?ot="#":("string"!=typeof ot||-1<at.BAD_DELIMITERS.indexOf(ot))&&(ot=!1),"\n"!==U&&"\r"!==U&&"\r\n"!==U&&(U="\n");var gt=0,mt=!1;this.parse=function(at,_t,vt){if("string"!=typeof at)throw new Error("Input must be a string");var wt=at.length,yt=L.length,bt=U.length,St=ot.length,Et=w(lt),kt=[],Ot=[],xt=[],Rt=gt=0;if(!at)return K();if(E.header&&!_t){var At=at.split(U)[0].split(L),Ct=[],$t={},jt=!1;for(var Tt in At){var Ft=At[Tt];w(E.transformHeader)&&(Ft=E.transformHeader(Ft,Tt));var zt=Ft,Dt=$t[Ft]||0;for(0<Dt&&(jt=!0,zt=Ft+"_"+Dt),$t[Ft]=Dt+1;Ct.includes(zt);)zt=zt+"_"+Dt;Ct.push(zt)}if(jt){var It=at.split(U);It[0]=Ct.join(L),at=It.join(U)}}if(ft||!1!==ft&&-1===at.indexOf(O)){for(var Lt=at.split(U),Nt=0;Nt<Lt.length;Nt++){if(xt=Lt[Nt],gt+=xt.length,Nt!==Lt.length-1)gt+=U.length;else if(vt)return K();if(!ot||xt.substring(0,St)!==ot){if(Et){if(kt=[],B(xt.split(L)),H(),mt)return K()}else B(xt.split(L));if(dt&&dt<=Nt)return kt=kt.slice(0,dt),K(!0)}}return K()}for(var Mt=at.indexOf(L,gt),Wt=at.indexOf(U,gt),Ut=new RegExp(p(pt)+p(O),"g"),Kt=at.indexOf(O,gt);;)if(at[gt]!==O)if(ot&&0===xt.length&&at.substring(gt,gt+St)===ot){if(-1===Wt)return K();gt=Wt+bt,Wt=at.indexOf(U,gt),Mt=at.indexOf(L,gt)}else if(-1!==Mt&&(Mt<Wt||-1===Wt))xt.push(at.substring(gt,Mt)),gt=Mt+yt,Mt=at.indexOf(L,gt);else{if(-1===Wt)break;if(xt.push(at.substring(gt,Wt)),q(Wt+bt),Et&&(H(),mt))return K();if(dt&&kt.length>=dt)return K(!0)}else for(Kt=gt,gt++;;){if(-1===(Kt=at.indexOf(O,Kt+1)))return vt||Ot.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:kt.length,index:gt}),G();if(Kt===wt-1)return G(at.substring(gt,Kt).replace(Ut,O));if(O!==pt||at[Kt+1]!==pt){if(O===pt||0===Kt||at[Kt-1]!==pt){-1!==Mt&&Mt<Kt+1&&(Mt=at.indexOf(L,Kt+1)),-1!==Wt&&Wt<Kt+1&&(Wt=at.indexOf(U,Kt+1));var Pt=P(-1===Wt?Mt:Math.min(Mt,Wt));if(at.substr(Kt+1+Pt,yt)===L){xt.push(at.substring(gt,Kt).replace(Ut,O)),at[gt=Kt+1+Pt+yt]!==O&&(Kt=at.indexOf(O,gt)),Mt=at.indexOf(L,gt),Wt=at.indexOf(U,gt);break}var Gt=P(Wt);if(at.substring(Kt+1+Gt,Kt+1+Gt+bt)===U){if(xt.push(at.substring(gt,Kt).replace(Ut,O)),q(Kt+1+Gt+bt),Mt=at.indexOf(L,gt),Kt=at.indexOf(O,gt),Et&&(H(),mt))return K();if(dt&&kt.length>=dt)return K(!0);break}Ot.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:kt.length,index:gt}),Kt++}}else Kt++}return G();function B(E){kt.push(E),Rt=gt}function P(E){var O=0;if(-1!==E){var L=at.substring(Kt+1,E);L&&""===L.trim()&&(O=L.length)}return O}function G(E){return vt||(void 0===E&&(E=at.substring(gt)),xt.push(E),gt=wt,B(xt),Et&&H()),K()}function q(E){gt=E,B(xt),xt=[],Wt=at.indexOf(U,gt)}function K(E){return{data:kt,errors:Ot,meta:{delimiter:L,linebreak:U,aborted:mt,truncated:!!E,cursor:Rt+(_t||0)}}}function H(){lt(K()),kt=[],Ot=[]}},this.abort=function(){mt=!0},this.getCharIndex=function(){return gt}}function m(E){var O=E.data,L=U[O.workerId],ot=!1;if(O.error)L.userError(O.error,O.file);else if(O.results&&O.results.data){var at={abort:function(){ot=!0,v(O.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:_,resume:_};if(w(L.userStep)){for(var lt=0;lt<O.results.data.length&&(L.userStep({data:O.results.data[lt],errors:O.results.errors,meta:O.results.meta},at),!ot);lt++);delete O.results}else w(L.userChunk)&&(L.userChunk(O.results,at,O.file),delete O.results)}O.finished&&!ot&&v(O.workerId,O.results)}function v(E,O){var L=U[E];w(L.userComplete)&&L.userComplete(O),L.terminate(),delete U[E]}function _(){throw new Error("Not implemented.")}function y(E){if("object"!=typeof E||null===E)return E;var O=Array.isArray(E)?[]:{};for(var L in E)O[L]=y(E[L]);return O}function b(E,O){return function(){E.apply(O,arguments)}}function w(E){return"function"==typeof E}return L&&(E.onmessage=function(O){var L=O.data;if(void 0===at.WORKER_ID&&L&&(at.WORKER_ID=L.workerId),"string"==typeof L.input)E.postMessage({workerId:at.WORKER_ID,results:at.parse(L.input,L.config),finished:!0});else if(E.File&&L.input instanceof File||L.input instanceof Object){var U=at.parse(L.input,L.config);U&&E.postMessage({workerId:at.WORKER_ID,results:U,finished:!0})}}),(h.prototype=Object.create(c.prototype)).constructor=h,(l.prototype=Object.create(c.prototype)).constructor=l,(d.prototype=Object.create(d.prototype)).constructor=d,(u.prototype=Object.create(c.prototype)).constructor=u,at}()),wt.exports));const bt="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,St=new Set,Et="object"==typeof process&&process?process:{},A=(E,O,L,U)=>{"function"==typeof Et.emitWarning?Et.emitWarning(E,O,L,U):console.error(`[${L}] ${O}: ${E}`)};let kt=globalThis.AbortController,Ot=globalThis.AbortSignal;if(void 0===kt){Ot=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(E,O){this._onabort.push(O)}},kt=class{constructor(){e()}signal=new Ot;abort(E){if(!this.signal.aborted){this.signal.reason=E,this.signal.aborted=!0;for(const O of this.signal._onabort)O(E);this.signal.onabort?.(E)}}};let E="1"!==Et.env?.LRU_CACHE_IGNORE_AC_WARNING;const e=()=>{E&&(E=!1,A("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}const T=E=>E&&E===Math.floor(E)&&E>0&&isFinite(E),F=E=>T(E)?E<=Math.pow(2,8)?Uint8Array:E<=Math.pow(2,16)?Uint16Array:E<=Math.pow(2,32)?Uint32Array:E<=Number.MAX_SAFE_INTEGER?R:null:null;class R extends Array{constructor(E){super(E),this.fill(0)}}class C{heap;length;static#t=!1;static create(E){const O=F(E);if(!O)return[];C.#t=!0;const L=new C(E,O);return C.#t=!1,L}constructor(E,O){if(!C.#t)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new O(E),this.length=0}push(E){this.heap[this.length++]=E}pop(){return this.heap[--this.length]}}class D{#e;#s;#r;#i;#n;#o;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#a;#c;#h;#l;#d;#u;#f;#p;#g;#m;#_;#v;#w;#y;#b;#S;#E;static unsafeExposeInternals(E){return{starts:E.#w,ttls:E.#y,sizes:E.#v,keyMap:E.#h,keyList:E.#l,valList:E.#d,next:E.#u,prev:E.#f,get head(){return E.#p},get tail(){return E.#g},free:E.#m,isBackgroundFetch:O=>E.#k(O),backgroundFetch:(O,L,U,ot)=>E.#O(O,L,U,ot),moveToTail:O=>E.#x(O),indexes:O=>E.#R(O),rindexes:O=>E.#A(O),isStale:O=>E.#C(O)}}get max(){return this.#e}get maxSize(){return this.#s}get calculatedSize(){return this.#c}get size(){return this.#a}get fetchMethod(){return this.#n}get memoMethod(){return this.#o}get dispose(){return this.#r}get disposeAfter(){return this.#i}constructor(E){const{max:O=0,ttl:L,ttlResolution:U=1,ttlAutopurge:ot,updateAgeOnGet:at,updateAgeOnHas:lt,allowStale:dt,dispose:ft,disposeAfter:pt,noDisposeOnSet:gt,noUpdateTTL:mt,maxSize:_t=0,maxEntrySize:vt=0,sizeCalculation:wt,fetchMethod:yt,memoMethod:bt,noDeleteOnFetchRejection:Et,noDeleteOnStaleGet:kt,allowStaleOnFetchRejection:Ot,allowStaleOnFetchAbort:xt,ignoreFetchAbort:Rt}=E;if(0!==O&&!T(O))throw new TypeError("max option must be a nonnegative integer");const At=O?F(O):Array;if(!At)throw new Error("invalid max value: "+O);if(this.#e=O,this.#s=_t,this.maxEntrySize=vt||this.#s,this.sizeCalculation=wt,this.sizeCalculation){if(!this.#s&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(void 0!==bt&&"function"!=typeof bt)throw new TypeError("memoMethod must be a function if defined");if(this.#o=bt,void 0!==yt&&"function"!=typeof yt)throw new TypeError("fetchMethod must be a function if specified");if(this.#n=yt,this.#S=!!yt,this.#h=new Map,this.#l=new Array(O).fill(void 0),this.#d=new Array(O).fill(void 0),this.#u=new At(O),this.#f=new At(O),this.#p=0,this.#g=0,this.#m=C.create(O),this.#a=0,this.#c=0,"function"==typeof ft&&(this.#r=ft),"function"==typeof pt?(this.#i=pt,this.#_=[]):(this.#i=void 0,this.#_=void 0),this.#b=!!this.#r,this.#E=!!this.#i,this.noDisposeOnSet=!!gt,this.noUpdateTTL=!!mt,this.noDeleteOnFetchRejection=!!Et,this.allowStaleOnFetchRejection=!!Ot,this.allowStaleOnFetchAbort=!!xt,this.ignoreFetchAbort=!!Rt,0!==this.maxEntrySize){if(0!==this.#s&&!T(this.#s))throw new TypeError("maxSize must be a positive integer if specified");if(!T(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#$()}if(this.allowStale=!!dt,this.noDeleteOnStaleGet=!!kt,this.updateAgeOnGet=!!at,this.updateAgeOnHas=!!lt,this.ttlResolution=T(U)||0===U?U:1,this.ttlAutopurge=!!ot,this.ttl=L||0,this.ttl){if(!T(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#j()}if(0===this.#e&&0===this.ttl&&0===this.#s)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#e&&!this.#s){const E="LRU_CACHE_UNBOUNDED";if((E=>!St.has(E))(E)){St.add(E);A("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",E,D)}}}getRemainingTTL(E){return this.#h.has(E)?1/0:0}#j(){const E=new R(this.#e),O=new R(this.#e);this.#y=E,this.#w=O,this.#T=(L,U,ot=bt.now())=>{if(O[L]=0!==U?ot:0,E[L]=U,0!==U&&this.ttlAutopurge){const E=setTimeout((()=>{this.#C(L)&&this.#F(this.#l[L],"expire")}),U+1);E.unref&&E.unref()}},this.#z=L=>{O[L]=0!==E[L]?bt.now():0},this.#D=(U,ot)=>{if(E[ot]){const at=E[ot],lt=O[ot];if(!at||!lt)return;U.ttl=at,U.start=lt,U.now=L||i();const dt=U.now-lt;U.remainingTTL=at-dt}};let L=0;const i=()=>{const E=bt.now();if(this.ttlResolution>0){L=E;const O=setTimeout((()=>L=0),this.ttlResolution);O.unref&&O.unref()}return E};this.getRemainingTTL=U=>{const ot=this.#h.get(U);if(void 0===ot)return 0;const at=E[ot],lt=O[ot];return at&&lt?at-((L||i())-lt):1/0},this.#C=U=>{const ot=O[U],at=E[U];return!!at&&!!ot&&(L||i())-ot>at}}#z=()=>{};#D=()=>{};#T=()=>{};#C=()=>!1;#$(){const E=new R(this.#e);this.#c=0,this.#v=E,this.#I=O=>{this.#c-=E[O],E[O]=0},this.#L=(E,O,L,U)=>{if(this.#k(O))return 0;if(!T(L)){if(!U)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if("function"!=typeof U)throw new TypeError("sizeCalculation must be a function");if(L=U(O,E),!T(L))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return L},this.#N=(O,L,U)=>{if(E[O]=L,this.#s){const L=this.#s-E[O];for(;this.#c>L;)this.#M(!0)}this.#c+=E[O],U&&(U.entrySize=L,U.totalCalculatedSize=this.#c)}}#I=E=>{};#N=(E,O,L)=>{};#L=(E,O,L,U)=>{if(L||U)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#R({allowStale:E=this.allowStale}={}){if(this.#a)for(let O=this.#g;this.#W(O)&&(!E&&this.#C(O)||(yield O),O!==this.#p);)O=this.#f[O]}*#A({allowStale:E=this.allowStale}={}){if(this.#a)for(let O=this.#p;this.#W(O)&&(!E&&this.#C(O)||(yield O),O!==this.#g);)O=this.#u[O]}#W(E){return void 0!==E&&this.#h.get(this.#l[E])===E}*entries(){for(const E of this.#R())void 0===this.#d[E]||void 0===this.#l[E]||this.#k(this.#d[E])||(yield[this.#l[E],this.#d[E]])}*rentries(){for(const E of this.#A())void 0===this.#d[E]||void 0===this.#l[E]||this.#k(this.#d[E])||(yield[this.#l[E],this.#d[E]])}*keys(){for(const E of this.#R()){const O=this.#l[E];void 0===O||this.#k(this.#d[E])||(yield O)}}*rkeys(){for(const E of this.#A()){const O=this.#l[E];void 0===O||this.#k(this.#d[E])||(yield O)}}*values(){for(const E of this.#R())void 0===this.#d[E]||this.#k(this.#d[E])||(yield this.#d[E])}*rvalues(){for(const E of this.#A())void 0===this.#d[E]||this.#k(this.#d[E])||(yield this.#d[E])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(E,O={}){for(const L of this.#R()){const U=this.#d[L],ot=this.#k(U)?U.__staleWhileFetching:U;if(void 0!==ot&&E(ot,this.#l[L],this))return this.get(this.#l[L],O)}}forEach(E,O=this){for(const L of this.#R()){const U=this.#d[L],ot=this.#k(U)?U.__staleWhileFetching:U;void 0!==ot&&E.call(O,ot,this.#l[L],this)}}rforEach(E,O=this){for(const L of this.#A()){const U=this.#d[L],ot=this.#k(U)?U.__staleWhileFetching:U;void 0!==ot&&E.call(O,ot,this.#l[L],this)}}purgeStale(){let E=!1;for(const O of this.#A({allowStale:!0}))this.#C(O)&&(this.#F(this.#l[O],"expire"),E=!0);return E}info(E){const O=this.#h.get(E);if(void 0===O)return;const L=this.#d[O],U=this.#k(L)?L.__staleWhileFetching:L;if(void 0===U)return;const ot={value:U};if(this.#y&&this.#w){const E=this.#y[O],L=this.#w[O];if(E&&L){const O=E-(bt.now()-L);ot.ttl=O,ot.start=Date.now()}}return this.#v&&(ot.size=this.#v[O]),ot}dump(){const E=[];for(const O of this.#R({allowStale:!0})){const L=this.#l[O],U=this.#d[O],ot=this.#k(U)?U.__staleWhileFetching:U;if(void 0===ot||void 0===L)continue;const at={value:ot};if(this.#y&&this.#w){at.ttl=this.#y[O];const E=bt.now()-this.#w[O];at.start=Math.floor(Date.now()-E)}this.#v&&(at.size=this.#v[O]),E.unshift([L,at])}return E}load(E){this.clear();for(const[O,L]of E){if(L.start){const E=Date.now()-L.start;L.start=bt.now()-E}this.set(O,L.value,L)}}set(E,O,L={}){if(void 0===O)return this.delete(E),this;const{ttl:U=this.ttl,start:ot,noDisposeOnSet:at=this.noDisposeOnSet,sizeCalculation:lt=this.sizeCalculation,status:dt}=L;let{noUpdateTTL:ft=this.noUpdateTTL}=L;const pt=this.#L(E,O,L.size||0,lt);if(this.maxEntrySize&&pt>this.maxEntrySize)return dt&&(dt.set="miss",dt.maxEntrySizeExceeded=!0),this.#F(E,"set"),this;let gt=0===this.#a?void 0:this.#h.get(E);if(void 0===gt)gt=0===this.#a?this.#g:0!==this.#m.length?this.#m.pop():this.#a===this.#e?this.#M(!1):this.#a,this.#l[gt]=E,this.#d[gt]=O,this.#h.set(E,gt),this.#u[this.#g]=gt,this.#f[gt]=this.#g,this.#g=gt,this.#a++,this.#N(gt,pt,dt),dt&&(dt.set="add"),ft=!1;else{this.#x(gt);const L=this.#d[gt];if(O!==L){if(this.#S&&this.#k(L)){L.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:O}=L;void 0===O||at||(this.#b&&this.#r?.(O,E,"set"),this.#E&&this.#_?.push([O,E,"set"]))}else at||(this.#b&&this.#r?.(L,E,"set"),this.#E&&this.#_?.push([L,E,"set"]));if(this.#I(gt),this.#N(gt,pt,dt),this.#d[gt]=O,dt){dt.set="replace";const E=L&&this.#k(L)?L.__staleWhileFetching:L;void 0!==E&&(dt.oldValue=E)}}else dt&&(dt.set="update")}if(0===U||this.#y||this.#j(),this.#y&&(ft||this.#T(gt,U,ot),dt&&this.#D(dt,gt)),!at&&this.#E&&this.#_){const E=this.#_;let O;for(;O=E?.shift();)this.#i?.(...O)}return this}pop(){try{for(;this.#a;){const E=this.#d[this.#p];if(this.#M(!0),this.#k(E)){if(E.__staleWhileFetching)return E.__staleWhileFetching}else if(void 0!==E)return E}}finally{if(this.#E&&this.#_){const E=this.#_;let O;for(;O=E?.shift();)this.#i?.(...O)}}}#M(E){const O=this.#p,L=this.#l[O],U=this.#d[O];return this.#S&&this.#k(U)?U.__abortController.abort(new Error("evicted")):(this.#b||this.#E)&&(this.#b&&this.#r?.(U,L,"evict"),this.#E&&this.#_?.push([U,L,"evict"])),this.#I(O),E&&(this.#l[O]=void 0,this.#d[O]=void 0,this.#m.push(O)),1===this.#a?(this.#p=this.#g=0,this.#m.length=0):this.#p=this.#u[O],this.#h.delete(L),this.#a--,O}has(E,O={}){const{updateAgeOnHas:L=this.updateAgeOnHas,status:U}=O,ot=this.#h.get(E);if(void 0!==ot){const E=this.#d[ot];if(this.#k(E)&&void 0===E.__staleWhileFetching)return!1;if(!this.#C(ot))return L&&this.#z(ot),U&&(U.has="hit",this.#D(U,ot)),!0;U&&(U.has="stale",this.#D(U,ot))}else U&&(U.has="miss");return!1}peek(E,O={}){const{allowStale:L=this.allowStale}=O,U=this.#h.get(E);if(void 0===U||!L&&this.#C(U))return;const ot=this.#d[U];return this.#k(ot)?ot.__staleWhileFetching:ot}#O(E,O,L,U){const ot=void 0===O?void 0:this.#d[O];if(this.#k(ot))return ot;const at=new kt,{signal:lt}=L;lt?.addEventListener("abort",(()=>at.abort(lt.reason)),{signal:at.signal});const dt={signal:at.signal,options:L,context:U},c=(U,ot=!1)=>{const{aborted:lt}=at.signal,pt=L.ignoreFetchAbort&&void 0!==U;if(L.status&&(lt&&!ot?(L.status.fetchAborted=!0,L.status.fetchError=at.signal.reason,pt&&(L.status.fetchAbortIgnored=!0)):L.status.fetchResolved=!0),lt&&!pt&&!ot)return h(at.signal.reason);const gt=ft;return this.#d[O]===ft&&(void 0===U?gt.__staleWhileFetching?this.#d[O]=gt.__staleWhileFetching:this.#F(E,"fetch"):(L.status&&(L.status.fetchUpdated=!0),this.set(E,U,dt.options))),U},h=U=>{const{aborted:ot}=at.signal,lt=ot&&L.allowStaleOnFetchAbort,dt=lt||L.allowStaleOnFetchRejection,pt=dt||L.noDeleteOnFetchRejection,gt=ft;this.#d[O]===ft&&(pt&&void 0!==gt.__staleWhileFetching?lt||(this.#d[O]=gt.__staleWhileFetching):this.#F(E,"fetch"));if(dt)return L.status&&void 0!==gt.__staleWhileFetching&&(L.status.returnedStale=!0),gt.__staleWhileFetching;if(gt.__returned===gt)throw U};L.status&&(L.status.fetchDispatched=!0);const ft=new Promise(((O,U)=>{const lt=this.#n?.(E,ot,dt);lt&&lt instanceof Promise&&lt.then((E=>O(void 0===E?void 0:E)),U),at.signal.addEventListener("abort",(()=>{L.ignoreFetchAbort&&!L.allowStaleOnFetchAbort||(O(void 0),L.allowStaleOnFetchAbort&&(O=E=>c(E,!0)))}))})).then(c,(E=>(L.status&&(L.status.fetchRejected=!0,L.status.fetchError=E),h(E)))),pt=Object.assign(ft,{__abortController:at,__staleWhileFetching:ot,__returned:void 0});return void 0===O?(this.set(E,pt,{...dt.options,status:void 0}),O=this.#h.get(E)):this.#d[O]=pt,pt}#k(E){if(!this.#S)return!1;const O=E;return!!O&&O instanceof Promise&&O.hasOwnProperty("__staleWhileFetching")&&O.__abortController instanceof kt}async fetch(E,O={}){const{allowStale:L=this.allowStale,updateAgeOnGet:U=this.updateAgeOnGet,noDeleteOnStaleGet:ot=this.noDeleteOnStaleGet,ttl:at=this.ttl,noDisposeOnSet:lt=this.noDisposeOnSet,size:dt=0,sizeCalculation:ft=this.sizeCalculation,noUpdateTTL:pt=this.noUpdateTTL,noDeleteOnFetchRejection:gt=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:mt=this.allowStaleOnFetchRejection,ignoreFetchAbort:_t=this.ignoreFetchAbort,allowStaleOnFetchAbort:vt=this.allowStaleOnFetchAbort,context:wt,forceRefresh:yt=!1,status:bt,signal:St}=O;if(!this.#S)return bt&&(bt.fetch="get"),this.get(E,{allowStale:L,updateAgeOnGet:U,noDeleteOnStaleGet:ot,status:bt});const Et={allowStale:L,updateAgeOnGet:U,noDeleteOnStaleGet:ot,ttl:at,noDisposeOnSet:lt,size:dt,sizeCalculation:ft,noUpdateTTL:pt,noDeleteOnFetchRejection:gt,allowStaleOnFetchRejection:mt,allowStaleOnFetchAbort:vt,ignoreFetchAbort:_t,status:bt,signal:St};let kt=this.#h.get(E);if(void 0===kt){bt&&(bt.fetch="miss");const O=this.#O(E,kt,Et,wt);return O.__returned=O}{const O=this.#d[kt];if(this.#k(O)){const E=L&&void 0!==O.__staleWhileFetching;return bt&&(bt.fetch="inflight",E&&(bt.returnedStale=!0)),E?O.__staleWhileFetching:O.__returned=O}const ot=this.#C(kt);if(!yt&&!ot)return bt&&(bt.fetch="hit"),this.#x(kt),U&&this.#z(kt),bt&&this.#D(bt,kt),O;const at=this.#O(E,kt,Et,wt),lt=void 0!==at.__staleWhileFetching&&L;return bt&&(bt.fetch=ot?"stale":"refresh",lt&&ot&&(bt.returnedStale=!0)),lt?at.__staleWhileFetching:at.__returned=at}}async forceFetch(E,O={}){const L=await this.fetch(E,O);if(void 0===L)throw new Error("fetch() returned undefined");return L}memo(E,O={}){const L=this.#o;if(!L)throw new Error("no memoMethod provided to constructor");const{context:U,forceRefresh:ot,...at}=O,lt=this.get(E,at);if(!ot&&void 0!==lt)return lt;const dt=L(E,lt,{options:at,context:U});return this.set(E,dt,at),dt}get(E,O={}){const{allowStale:L=this.allowStale,updateAgeOnGet:U=this.updateAgeOnGet,noDeleteOnStaleGet:ot=this.noDeleteOnStaleGet,status:at}=O,lt=this.#h.get(E);if(void 0!==lt){const O=this.#d[lt],dt=this.#k(O);return at&&this.#D(at,lt),this.#C(lt)?(at&&(at.get="stale"),dt?(at&&L&&void 0!==O.__staleWhileFetching&&(at.returnedStale=!0),L?O.__staleWhileFetching:void 0):(ot||this.#F(E,"expire"),at&&L&&(at.returnedStale=!0),L?O:void 0)):(at&&(at.get="hit"),dt?O.__staleWhileFetching:(this.#x(lt),U&&this.#z(lt),O))}at&&(at.get="miss")}#U(E,O){this.#f[O]=E,this.#u[E]=O}#x(E){E!==this.#g&&(E===this.#p?this.#p=this.#u[E]:this.#U(this.#f[E],this.#u[E]),this.#U(this.#g,E),this.#g=E)}delete(E){return this.#F(E,"delete")}#F(E,O){let L=!1;if(0!==this.#a){const U=this.#h.get(E);if(void 0!==U)if(L=!0,1===this.#a)this.#K(O);else{this.#I(U);const L=this.#d[U];if(this.#k(L)?L.__abortController.abort(new Error("deleted")):(this.#b||this.#E)&&(this.#b&&this.#r?.(L,E,O),this.#E&&this.#_?.push([L,E,O])),this.#h.delete(E),this.#l[U]=void 0,this.#d[U]=void 0,U===this.#g)this.#g=this.#f[U];else if(U===this.#p)this.#p=this.#u[U];else{const E=this.#f[U];this.#u[E]=this.#u[U];const O=this.#u[U];this.#f[O]=this.#f[U]}this.#a--,this.#m.push(U)}}if(this.#E&&this.#_?.length){const E=this.#_;let O;for(;O=E?.shift();)this.#i?.(...O)}return L}clear(){return this.#K("delete")}#K(E){for(const O of this.#A({allowStale:!0})){const L=this.#d[O];if(this.#k(L))L.__abortController.abort(new Error("deleted"));else{const U=this.#l[O];this.#b&&this.#r?.(L,U,E),this.#E&&this.#_?.push([L,U,E])}}if(this.#h.clear(),this.#d.fill(void 0),this.#l.fill(void 0),this.#y&&this.#w&&(this.#y.fill(0),this.#w.fill(0)),this.#v&&this.#v.fill(0),this.#p=0,this.#g=0,this.#m.length=0,this.#c=0,this.#a=0,this.#E&&this.#_){const E=this.#_;let O;for(;O=E?.shift();)this.#i?.(...O)}}}function j(E){return E.pref}function $(E){return`${E.county||""}${E.city}${E.ward||""}`}function I(E){return`${E.oaza_cho||""}${E.chome||""}${E.koaza||""}`}function M(E){return[E.blk_num,E.rsdt_num,E.rsdt_num2].filter(Boolean).join("-")}function N(E){return[E.prc_num1,E.prc_num2,E.prc_num3].filter(Boolean).join("-")}const xt=new D({max:pt.cacheSize});function W(E,O){return t(this,void 0,void 0,(function*(){let L=xt.get(E);return void 0!==L||(L=yield O(),xt.set(E,L)),L}))}let Rt;const At=new Map;let Ct;const $t={};let jt;const H=E=>Ct=E,Q=E=>{const O=At.get(E.code);if(void 0!==O)return O;const L=E.cities;L.sort(((E,O)=>$(E).length-$(O).length));const U=L.map((E=>{const O=$(E);let L=`^${b(O)}`;return O.match(/(町|村)$/)&&(L=`^${b(O).replace(/(.+?)郡/,"($1郡)?")}`),[E,L]}));return At.set(E.code,U),U};function J(E,O,L,U,ot){return t(this,void 0,void 0,(function*(){const at=j(O),lt=$(L);return(yield p(["",encodeURI(at),encodeURI(`${lt}-${E}.txt?v=${ot}`)].join("/"),{offset:U.start,length:U.length})).text()}))}function V(E){const O=E.indexOf("\n"),L=E.slice(O+1),U=yt.parse(L,{header:!0}).data,ot=[];for(const E of U){const O=E.lng&&E.lat?[parseFloat(E.lng),parseFloat(E.lat)]:void 0;"blk_num"in E?ot.push({blk_num:E.blk_num,rsdt_num:E.rsdt_num,rsdt_num2:E.rsdt_num2,point:O}):"prc_num1"in E&&ot.push({prc_num1:E.prc_num1,prc_num2:E.prc_num2,prc_num3:E.prc_num3,point:O})}return ot}const Y=E=>{const O=E.match(/.町/g);return!!O&&ft.findKanjiNumbers(O[0]).length>0},Z=(E,O,L)=>t(void 0,void 0,void 0,(function*(){return W(`${E.code}-${O.code}`,(()=>t(void 0,void 0,void 0,(function*(){const U=yield((E,O,L)=>t(void 0,void 0,void 0,(function*(){const U=j(E),ot=$(O),at=`${U}-${ot}`,lt=$t[at];if(void 0!==lt)return lt;const dt=yield p(["",encodeURI(U),encodeURI(ot)+`.json?v=${L}`].join("/"),{}),ft=yield dt.json();return $t[at]=ft})))(E,O,L),ot=U.data,at=new Set(ot.map((E=>I(E)))),lt=[],dt="京都市"===O.city;for(const E of ot){lt.push(E);const O=I(E);if(-1===O.indexOf("町"))continue;const L=O.replace(/(?!^町)町/g,"");dt||at.has(L)||at.has(`大字${L}`)||Y(O)||lt.push({machiaza_id:E.machiaza_id,point:E.point,oaza_cho:L,originalTown:E})}lt.sort(((E,O)=>{let L=I(E).length,U=I(O).length;return I(E).startsWith("大字")&&(L-=2),I(O).startsWith("大字")&&(U-=2),U-L}));const pt=lt.map((E=>{const O=b(I(E).replace(/[-－﹣−‐⁃‑‒–—﹘―⎯⏤ーｰ─━]/g,"[-－﹣−‐⁃‑‒–—﹘―⎯⏤ーｰ─━]").replace(/大?字/g,"(大?字)?").replace(/([壱一二三四五六七八九十]+|[１２３４５６７８９０]+)(丁目?|番(町|丁)|条|軒|線|(の|ノ)町|地割|号)/g,(E=>{const O=[];if(O.push(E.toString().replace(/(丁目?|番(町|丁)|条|軒|線|(の|ノ)町|地割|号)/,"")),E.match(/^壱/))O.push("一"),O.push("1"),O.push("１");else{const L=E.replace(/([一二三四五六七八九十]+)/g,(E=>g(E))).replace(/([１２３４５６７８９０]+)/g,(E=>ft.kanji2number(E).toString())).replace(/(丁目?|番(町|丁)|条|軒|線|(の|ノ)町|地割|号)/,"");O.push(L.toString())}return`(${O.join("|")})((丁|町)目?|番(町|丁)|条|軒|線|の町?|地割|号|[-－﹣−‐⁃‑‒–—﹘―⎯⏤ーｰ─━])`})));return["originalTown"in E?E.originalTown:E,O]}));for(const E of lt){const O=I(E).match(/([^一二三四五六七八九十]+)([一二三四五六七八九十]+)(丁目?)/);if(!O)continue;const L=O[1],U=O[2],ot=b(`^${L}(${U}|${g(U)})`);pt.push([E,ot])}return pt}))))}));function X(E){return{lat:E.point[1],lng:E.point[0],level:1}}function tt(E){return{lat:E.point[1],lng:E.point[0],level:2}}function et(E){if(E.point)return{lat:E.point[1],lng:E.point[0],level:3}}function st(E){if(E.point)return{lat:E.point[1],lng:E.point[0],level:8}}function it(E,O){return E?O?E.level>O.level?E:O:E:O}function rt(E){if(!E)return;const O=Object.assign({},E);return delete O.cities,O}function nt(E){if(!E)return;const O=Object.assign({},E);return delete O.csv_ranges,O}const Tt=pt,Ft={level:8},ct=(E,O,L,U)=>t(void 0,void 0,void 0,(function*(){E=E.trim().replace(/^大字/,"");const ot=yield Z(O,L,U),at=["^"];"京都市"===L.city&&at.push(".*");for(const O of at)for(const[L,U]of ot){const ot=new RegExp(`${O}${U}`),at=E.match(ot);if(at)return{town:L,other:E.substring(at[0].length)}}}));function ht(E,O,L,U,ot){return t(this,void 0,void 0,(function*(){const at=E.match(/^([1-9][0-9]*)(?:-([1-9][0-9]*))?(?:-([1-9][0-9]*))?/);if(!at)return{rest:E};if(U.rsdt){const lt=yield((E,O,L,U)=>t(void 0,void 0,void 0,(function*(){var ot;const at=null===(ot=L.csv_ranges)||void 0===ot?void 0:ot.住居表示;return at?yield W(`住居表示-${E.code}-${O.code}-${I(L)}`,(()=>t(void 0,void 0,void 0,(function*(){const L=V(yield J("住居表示",E,O,at,U));return L.sort(((E,O)=>{const L=[E.blk_num,E.rsdt_num,E.rsdt_num2].filter((E=>!!E)).join("-"),U=[O.blk_num,O.rsdt_num,O.rsdt_num2].filter((E=>!!E)).join("-");return U.length-L.length})),L})))):[]})))(O,L,U,ot);for(const O of lt){const L=M(O);if(at[0]===L)return{rsdt:O,rest:E.substring(L.length)}}}else{const lt=yield((E,O,L,U)=>t(void 0,void 0,void 0,(function*(){var ot;const at=null===(ot=L.csv_ranges)||void 0===ot?void 0:ot.地番;return at?yield W(`地番-${E.code}-${O.code}-${I(L)}`,(()=>t(void 0,void 0,void 0,(function*(){const L=V(yield J("地番",E,O,at,U));return L.sort(((E,O)=>{const L=[E.prc_num1,E.prc_num2,E.prc_num3].filter((E=>!!E)).join("-"),U=[O.prc_num1,O.prc_num2,O.prc_num3].filter((E=>!!E)).join("-");return U.length-L.length})),L})))):[]})))(O,L,U,ot);for(const O of lt){const L=N(O);if(at[0]===L)return{chiban:O,rest:E.substring(L.length)}}}return{rest:E}}))}const zt="3.1.3",Dt=Tt,ut=(E,...O)=>t(void 0,[E,...O],void 0,(function*(E,O=Ft){var L;const U=Object.assign(Object.assign({},Ft),O);null!==(L=U.geoloniaApiKey)&&void 0!==L||(U.geoloniaApiKey=Tt.geoloniaApiKey);let ot=E.normalize("NFC").replace(/　/g," ").replace(/ +/g," ").replace(/([０-９Ａ-Ｚａ-ｚ]+)/g,(E=>m(E))).replace(/([0-9０-９一二三四五六七八九〇十百千][-－﹣−‐⁃‑‒–—﹘―⎯⏤ーｰ─━])|([-－﹣−‐⁃‑‒–—﹘―⎯⏤ーｰ─━])[0-9０-９一二三四五六七八九〇十]/g,(E=>E.replace(/[-－﹣−‐⁃‑‒–—﹘―⎯⏤ーｰ─━]/g,"-"))).replace(/(.+)(丁目?|番(町|地|丁)|条|軒|線|(の|ノ)町|地割)/,(E=>E.replace(/ /g,""))).replace(/(.+)((郡.+(町|村))|((市|巿).+(区|區)))/,(E=>E.replace(/ /g,""))).replace(/.+?[0-9一二三四五六七八九〇十百千]-/,(E=>E.replace(/ /g,"")));let at,lt,dt,pt,mt,_t=0;const vt=yield t(void 0,void 0,void 0,(function*(){if(void 0!==Ct)return Ct;const E=yield p(".json",{}),O=yield E.json();return H(O)})),wt=vt.meta.updated,yt=(E=>{if(Rt)return Rt;const O=E.data;return Rt=O.map((E=>{const O=E.pref.replace(/(都|道|府|県)$/,"");return[E,`^${O}(都|道|府|県)?`]})),Rt})(vt),bt=(E=>{if(void 0!==jt)return jt;const O=E.data,L=O.map((E=>E.pref.replace(/[都|道|府|県]$/,"")));jt=[];for(const E of O)for(const O of E.cities){const U=$(O);for(let O=0;O<L.length;O++)0===U.indexOf(L[O])&&jt.push([`${E.pref}${U}`,`^${U}`])}return jt})(vt);for(const[E,O]of bt)if(ot.match(O)){ot=ot.replace(new RegExp(O),E);break}for(const[E,O]of yt){const L=ot.match(O);if(L){at=E,ot=ot.substring(L[0].length),pt=X(at);break}}if(!at){const E=[];for(const O of vt.data){const L=Q(O);ot=ot.trim();for(const[U,at]of L){const L=ot.match(at);L&&E.push({pref:O,city:U,other:ot.substring(L[0].length)})}}if(1===E.length)at=E[0].pref;else for(const O of E){const E=yield ct(O.other,O.pref,O.city,wt);E&&(at=O.pref,lt=O.city,dt=E.town,ot=E.other,pt=it(pt,et(dt)))}}if(at&&U.level>=2){const E=Q(at);ot=ot.trim();for(const[O,L]of E){const E=ot.match(L);if(E){lt=O,pt=it(pt,tt(lt)),ot=ot.substring(E[0].length);break}}}if(at&&lt&&U.level>=3){const E=yield ct(ot,at,lt,wt);E&&(dt=E.town,ot=E.other,pt=it(pt,et(dt))),dt&&(ot=ot.replace(/^-/,"").replace(/([0-9]+)(丁目)/g,(E=>E.replace(/([0-9]+)/g,(E=>ft.number2kanji(Number(E)))))).replace(/(([0-9]+|[〇一二三四五六七八九十百千]+)(番地?)([0-9]+|[〇一二三四五六七八九十百千]+)号)\s*(.+)/,"$1 $5").replace(/([0-9]+|[〇一二三四五六七八九十百千]+)\s*(番地?)\s*([0-9]+|[〇一二三四五六七八九十百千]+)\s*号?/,"$1-$3").replace(/([0-9]+|[〇一二三四五六七八九十百千]+)番(地|$)/,"$1").replace(/([0-9]+|[〇一二三四五六七八九十百千]+)の/g,"$1-").replace(/([0-9]+|[〇一二三四五六七八九十百千]+)[-－﹣−‐⁃‑‒–—﹘―⎯⏤ーｰ─━]/g,(E=>g(E).replace(/[-－﹣−‐⁃‑‒–—﹘―⎯⏤ーｰ─━]/g,"-"))).replace(/[-－﹣−‐⁃‑‒–—﹘―⎯⏤ーｰ─━]([0-9]+|[〇一二三四五六七八九十百千]+)/g,(E=>g(E).replace(/[-－﹣−‐⁃‑‒–—﹘―⎯⏤ーｰ─━]/g,"-"))).replace(/([0-9]+|[〇一二三四五六七八九十百千]+)-/,(E=>g(E))).replace(/-([0-9]+|[〇一二三四五六七八九十百千]+)/,(E=>g(E))).replace(/-[^0-9]([0-9]+|[〇一二三四五六七八九十百千]+)/,(E=>g(m(E)))).replace(/([0-9]+|[〇一二三四五六七八九十百千]+)$/,(E=>g(E))).trim())}if(ot=((E,O,L,U)=>{let ot=U;for(let U=0;U<gt.length;U++){const at=gt[U];at.pref===E&&at.city===O&&at.town===L&&(ot=ot.replace(new RegExp(at.pattern),at.result))}return ot})(at?j(at):"",lt?$(lt):"",dt?I(dt):"",ot),at&&(_t+=1),lt&&(_t+=1),dt&&(_t+=1),U.level<=3||_t<3)return{pref:at?j(at):void 0,city:lt?$(lt):void 0,town:dt?I(dt):void 0,other:ot,level:_t,point:pt,metadata:{input:E,prefecture:rt(at),city:lt,machiAza:nt(dt)}};const St=yield ht(ot,at,lt,dt,wt);St.rsdt?(mt=M(St.rsdt),ot=St.rest,pt=it(pt,st(St.rsdt)),_t=8):St.chiban&&(mt=N(St.chiban),ot=St.rest,pt=it(pt,st(St.chiban)),_t=8);return{pref:at?j(at):void 0,city:lt?$(lt):void 0,town:dt?I(dt):void 0,addr:mt,level:_t,point:pt,other:ot,metadata:{input:E,prefecture:rt(at),city:lt,machiAza:nt(dt),rsdt:St.rsdt,chiban:St.chiban}}}));export{Dt as config,ut as normalize,zt as version};

